id: http-missing-x-content-type-options

info:
  name: Missing X-Content-Type-Options Header
  author: socketz,geeknik,G4L1T0,convisoappsec,kurohost,dawid-czarnecki,forgedhallpass,jub0bs,userdehghani
  severity: info
  description: The 'X-Content-Type-Options' header is missing. This prevents MIME-type sniffing.
  metadata:
    max-request: 1
  tags: misconfig,headers,x-content-type-options

http:
  - method: GET
    path:
      - "{{BaseURL}}"
    host-redirects: true
    max-redirects: 3
    matchers:
      - type: dsl
        dsl:
          - "!regex('(?i)x-content-type-options', header)"
          - "status_code != 301 && status_code != 302"
        condition: and