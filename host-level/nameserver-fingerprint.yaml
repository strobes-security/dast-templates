id: nameserver-fingerprint
info:
  name: NS Record Detection
  author: pdteam
  severity: info
  description: The "NS Record Detection" vulnerability refers to the potential for
    attackers to exploit misconfigurations or unauthorized changes in the Domain Name
    System (DNS) records of a targeted domain. Specifically, this issue arises when
    the Name Server (NS) records, which define the authoritative DNS servers responsible
    for resolving the domain's queries, are not properly managed or secured. Threat
    actors could potentially hijack the domain by modifying the NS records to point
    to their own malicious name servers, allowing them to intercept and monitor all
    traffic to the affected domain, potentially gaining access to sensitive information.
    Additionally, the compromised domain could be used as a launch pad for further
    attacks, such as distributing malware or conducting phishing campaigns. To address
    this vulnerability, it is crucial to closely monitor and maintain strict control
    over your domain's DNS configuration, implementing strong access controls, regular
    auditing, and protective measures to prevent unauthorized modifications to the
    NS records.
  classification:
    cwe-id: CWE-200
  metadata:
    max-request: 1
  tags: dns,ns
  impact: '- Attackers could potentially hijack the targeted domain by modifying the
    NS record to point to their own malicious name servers.

    - Attackers could intercept and monitor all traffic to the targeted domain, potentially
    gaining access to sensitive information.

    - Attackers could set up their own web servers on the delegated subdomains and
    use them to host malicious content or conduct phishing attacks.

    - Attackers could use the compromised domain to launch further attacks, such as
    distributing malware or launching denial-of-service (DoS) attacks.

    - The compromised domain could be used as a stepping stone for deeper network
    intrusion and lateral movement within the target organization.'
  remediation: 'To address the "NS Record Detection" vulnerability, it is crucial
    to review and properly manage your domain''s DNS configuration. Misconfigured
    or unauthorized changes to NS records can lead to significant security risks,
    such as domain hijacking, traffic interception, and the potential for further
    attacks.


    - Thoroughly audit your domain''s DNS settings to identify any unauthorized or
    unexpected NS records. Verify that all NS records are legitimate and managed by
    your organization.

    - Implement strict access controls and multi-factor authentication for making
    changes to your domain''s DNS configuration. Ensure that only authorized personnel
    can modify NS records.

    - Consider implementing domain protection services or registry locks to prevent
    unauthorized changes to your domain''s NS records.

    - Regularly monitor your domain''s DNS records and set up alerts to notify you
    of any changes, enabling you to respond promptly to potential threats.

    - Educate your team on the importance of maintaining a secure DNS configuration
    and the risks associated with NS record vulnerabilities.'
dns:
- name: '{{FQDN}}'
  type: NS
  matchers:
  - type: regex
    part: answer
    regex:
    - "IN\tNS\\t(.+)$"
  extractors:
  - type: regex
    group: 1
    regex:
    - "IN\tNS\t(.+)"
