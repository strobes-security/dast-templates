id: caa-fingerprint
info:
  name: CAA Record
  author: pdteam
  severity: info
  description: A CAA record was discovered. A CAA record is used to specify which
    certificate authorities (CAs) are allowed to issue certificates for a domain.
  reference:
  - https://support.dnsimple.com/articles/caa-record/#whats-a-caa-record
  classification:
    cwe-id: CWE-200
  metadata:
    max-request: 1
  tags: dns,caa
  impact: '- An attacker could potentially bypass the domain''s CAA record restrictions
    and obtain a valid SSL/TLS certificate for the domain from an unauthorized CA.

    - The attacker could use the rogue certificate to intercept and decrypt the domain''s
    encrypted traffic, potentially exposing sensitive information.

    - The attacker could leverage the rogue certificate to conduct man-in-the-middle
    attacks, impersonating the legitimate domain and tricking users into revealing
    sensitive credentials.

    - If the domain''s CAA record is not properly configured, the attacker could abuse
    this vulnerability to obtain valid certificates for the domain from any CA, effectively
    circumventing the intended security controls.

    - The compromise of the domain''s CAA record could lead to a broader attack surface,
    enabling the attacker to further exploit the domain and its associated systems
    and services.'
  remediation: 'The CAA record vulnerability must be addressed to prevent unauthorized
    parties from obtaining valid SSL/TLS certificates for the domain, which could
    enable man-in-the-middle attacks, traffic interception, and the exposure of sensitive
    information. To remediate this issue, the domain''s CAA record should be properly
    configured to specify the authorized certificate authorities (CAs) allowed to
    issue certificates for the domain.


    - Review the domain''s existing CAA record and ensure that it accurately reflects
    the list of authorized CAs.

    - Update the CAA record to include all the CAs that are allowed to issue certificates
    for the domain.

    - Ensure that the CAA record is set to "critical" to enforce the specified restrictions
    and prevent unauthorized CAs from issuing certificates.

    - Monitor the domain''s CAA record regularly and update it as necessary to reflect
    any changes in the authorized CAs.

    - Implement a process to regularly review and validate the accuracy of the domain''s
    CAA record to maintain robust security controls.'
dns:
- name: '{{FQDN}}'
  type: CAA
  matchers:
  - type: regex
    regex:
    - IN\s+CAA\s+(.+)
  extractors:
  - type: regex
    group: 1
    regex:
    - issue "(.*)"
    - issuewild "(.*)"
    - iodef "(.*)"
